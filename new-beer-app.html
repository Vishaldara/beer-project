<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Beers Project</title>
	<!-- Latest compiled and minified CSS -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
	<style>
		#results {
			margin:10px 0;
			border:1px solid #aaa;
			padding: 10px;
			background: #eee
		}
		#details img {
			float:left;
			margin-right:30px;
			margin-bottom:10px;
		}
		.clearfix {
			clear:both;
		}
		.hidden {
			display:none;
		}
	</style>

</head>
<body>
	<div class="container">

		<form action="" method="POST" role="form" id="search-beer">
			<legend>Beers Project</legend>
			<div class="form-group">
				<label for="">Look for a beer</label>
				<input type="text" class="input-lg form-control" id="" placeholder="Enter some beers' name">
			</div>
			<button id="" type="submit" class="btn btn-primary">Search!</button>
		</form>

		<div id="results" class="hidden">
			<p>Beers found:</p>
			<select class="input-lg"></select>
		</div>

		<div id="details" class="hidden">
			<div class="jumbotron">
				<h1>Hello, world!</h1>
				<img class="img-circle" src="" alt="">
				<p class="description"></p>
				<p class="organic">This beer <strong></strong> organic</p>
				<div class="clearfix"></div>
			</div>
		</div>

	</div>
	<script src="https://code.jquery.com/jquery-2.0.3.min.js"></script>
	<script>

		$("#search-beer button").on('click', function(event) {
			event.preventDefault();
			var beerSearched = $("#search-beer input").val();
			var urlSearchBeer = 'https://quiet-inlet-67115.herokuapp.com/api/search/all?q=' + beerSearched

			$.ajax({
				url: urlSearchBeer,
				dataType: 'json'
			})
			.success( function( aData ) {

				var itemsHtml = "";
				$.each(aData, function(i, oBeer) {
					itemsHtml += '<option value="' + oBeer.id + '">' + oBeer.name + '</option>';
				})

				$('#results').removeClass("hidden");

				$("#results select").html(itemsHtml);

			})

		});

		$("#results select").on('change', function() {

			var idBeer = $(this).val();
			var urlDetailsBeer = 'https://quiet-inlet-67115.herokuapp.com/api/beer/' + idBeer;

			$.ajax({
				url: urlDetailsBeer,
				dataType: 'json'
			})
			.success(function( oDataBeer ) {
				console.log (oDataBeer);
				$('#details').removeClass("hidden");

				$("#details h1").html(oDataBeer.name)
				$("#details p.description").html(oDataBeer.description)

				if (oDataBeer.labels) {
					$("#details img").attr("src", oDataBeer.labels.medium);
				}

				if (oDataBeer.isOrganic === "N") {
					$("#details p.organic strong").html("IS NOT");
				}
				else {
					$("#details p.organic strong").html("IS");
				}

			})

		});


	</script>

</body>
</html>